<!DOCTYPE html>
<html LANG="en">
<head>
    <meta charset="utf-8">
    <title>å¤æ‚svgå¤´åƒç”Ÿæˆ</title>
    <script src="study-web-svg/cartoon-avatar/materials/mouth.js"></script>
    <script src="study-web-svg/cartoon-avatar/materials/accessories.js"></script>
    <script src="study-web-svg/cartoon-avatar/materials/clothes.js"></script>
    <script src="study-web-svg/cartoon-avatar/materials/eyebrows.js"></script>
    <script src="study-web-svg/cartoon-avatar/materials/eyes.js"></script>
    <script src="study-web-svg/cartoon-avatar/materials/hair.js"></script>
    <script src="study-web-svg/cartoon-avatar/materials/shirt.js"></script>
    <script src="study-web-svg/cartoon-avatar/materials/top.js"></script>

    <script>
        "use strict";
        const materials = {//å¡é€šå›¾svgå…ƒç´ 
            mouthType: window.mouthTypes, //å˜´å·´
            eyeType: window.eyeTypes, //çœ¼ç›
            topType: window.topTypes, //å¡é€šå›¾æ•´ä½“
            clothesType: window.clothesType, //è¡£æœ
            eyebrowType: window.eyebrowTypes, //çœ‰æ¯›
            facialHairType: window.facialHairTypes, //èƒ¡é¡»
            accessoriesType: window.accessoriesTypes, //çœ¼é•œ
            graphicShirtType: window.GraphicShirtTypes, //å›¾æ¡ˆè¡¬è¡«
            hatColor: { //å¸½å­é¢œè‰²
                Black: "#262E33",
                Blue01: "#65C9FF",
                Blue02: "#5199E4",
                Blue03: "#25557C",
                Gray01: "#E6E6E6",
                Gray02: "#929598",
                Heather: "#3C4F5C",
                PastelBlue: "#B1E2FF",
                PastelGreen: "#A7FFC4",
                PastelOrange: "#FFDEB5",
                PastelRed: "#FFAFB9",
                PastelYellow: "#cece16",
                Pink: "#FF488E",
                Red: "#FF5C5C",
                White: "#d61717"
            },
            shirtColor: { //Tæ¤è¡«é¢œè‰²
                Black: "#262E33",
                Blue01: "#65C9FF",
                Blue02: "#5199E4",
                Blue03: "#25557C",
                Gray01: "#E6E6E6",
                Gray02: "#929598",
                Heather: "#3C4F5C",
                PastelBlue: "#B1E2FF",
                PastelGreen: "#A7FFC4",
                PastelOrange: "#FFDEB5",
                PastelRed: "#FFAFB9",
                PastelYellow: "#cece16",
                Pink: "#FF488E",
                Red: "#FF5C5C",
                White: "#d61717"
            },
            hairColor: { //å¤´å‘é¢œè‰²
                Auburn: "#A55728",
                Black: "#2C1B18",
                Blonde: "#B58143",
                BlondeGolden: "#D6B370",
                Brown: "#724133",
                BrownDark: "#4A312C",
                PastelPink: "#F59797",
                Platinum: "#ECDCBF",
                Red: "#C93305",
                SilverGray: "#E8E1E1"
            },
            facialHairColor: { //èƒ¡é¡»é¢œè‰²
                Auburn: "#A55728",
                Black: "#2C1B18",
                Blonde: "#B58143",
                BlondeGolden: "#D6B370",
                Brown: "#724133",
                BrownDark: "#4A312C",
                PastelPink: "#F59797",
                Platinum: "#ECDCBF",
                Red: "#C93305",
                SilverGray: "#E8E1E1"
            },
            skinColor: { //çš®è‚¤é¢œè‰²
                Tanned: "#FD9841",
                Yellow: "#F8D25C",
                Pale: "#FFDBB4",
                Light: "#EDB98A",
                Brown: "#D08B5B",
                DarkBrown: "#AE5D29",
                Black: "#614335"
            }
        }
        const options = [];
        for (const optionName in materials) {
            //å‡†å¤‡ä¸€ä¸ªå¯¹è±¡,å­˜å‚¨æ•°æ®,ä¸€ä¸ªsvgå…ƒç´ å¯¹è±¡,å¯¹åº”å¤§é‡çš„å±æ€§.
            let option = {
                name: optionName,
                values: []
            };
            const optionValues = materials[optionName];
            for (const optionValueKey in optionValues) {
                //æ£€æŸ¥å¯¹è±¡æ˜¯å¦æœ‰å±æ€§.
                if (optionValues.hasOwnProperty(optionValueKey)) {
                    option.values.push(optionValues[optionValueKey]);
                }
            }
            options.push(option);
        }

        //ç”Ÿæˆ13ä¸ªsvgå…ƒç´ å¯¹è±¡.
        function svgGenerate(uuid) {
            let option = {};
            let hash = uuid;
            //console.log(hash)
            // å¾ªç¯13ä¸ªsvgå…ƒç´ ,éšæœºç”Ÿæˆæ¯ä¸€ä¸ªéƒ¨åˆ†.
            options.forEach(element => {
                //æ¯8ä½æˆªå–ä¸€æ¬¡,ç”Ÿæˆä¸€æ¬¡å…ƒç´ .
                let num = parseInt(hash.substring(0, 8), 16);
                //console.log(hash.substring(0, 8))
                //å°†16è¿›åˆ¶çš„4ä½æ•°è½¬æˆ10è¿›åˆ¶çš„æ•°å­—,ç”¨å¾—åˆ°çš„numå¯¹å…ƒç´ çš„æ•°é‡è¿›è¡Œå–ä½™.
                let valueIndex = num % element.values.length;
                option[element.name] = element.values[valueIndex];
                hash = hash.substring(8);
            });
            //ç”¨13ä¸ªsvgå…ƒç´ ,åŠ ä¸Šsvgæ¨¡æ¿,ç”Ÿæˆä¸€å¼ å¡é€šå›¾åƒ.
            return svgTemplate(option);
        }

        //ç”Ÿæˆä¸€ä¸ªé•¿åº¦ç­‰äº4ä½çš„code.
        function S4() {
            // (1 + Math.random()) ç»“æœæ˜¯1ç‚¹å‡ æ•°å€¼,1ç‚¹å‡ *0x10000ç»“æœå°±æ˜¯ä¸€ä¸ªäº”ä½æ•´æ•°åŠ å°æ•°çš„æ•°å€¼,
            // å†|0å°±æ˜¯å–æ•´æ•°,
            // åˆ°è¿™é‡Œå°±å¾—åˆ°ä¸€ä¸ªäº”ä½æ•°æ•°å€¼äº†,å†toString(16)å°±æ˜¯æ¢æˆäº”ä½æ•°å­—ç¬¦ä¸²,
            // å†substring(1)å°±æ˜¯ä»ç¬¬2ä¸ªä½ç½®å¼€å§‹æˆªå–ï¼Œæœ€åå°±å¾—åˆ°ä¸€ä¸ªå››ä½æ•°çš„éšæœºå­—ç¬¦ä¸².
            return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);
        }

        //ç”Ÿæˆä¸€ä¸ªé•¿åº¦4*26çš„code.(ä¸€ä¸ªsvgå…ƒç´ ä½¿ç”¨8ä½,13ä¸ªå…ƒç´ ),åªè¦è¶³å¤Ÿéšæœºå³å¯,è¿™ä¸ªéšæœºç®—æ³•æ¯”è¾ƒå·®,æµ‹è¯•ç”¨å³å¯.
        function guid() {
            //ç”Ÿæˆ4*26ä½16è¿›åˆ¶å­—ç¬¦ä¸².
            return (
                S4() + S4() + S4() + S4() + S4() + S4() + S4() + S4() + S4()
                + S4() + S4() + S4() + S4() + S4() + S4() + S4() + S4() + S4()
                + S4() + S4() + S4() + S4() + S4() + S4() + S4() + S4());
        }

        function clearSvg() {
            let main = document.getElementById("main");
            main.innerHTML = "";
        }

        //ç”Ÿæˆå¡é€šå¤´åƒ
        function createSvg() {
            //å¾—åˆ°4*26ä½çš„é•¿åº¦code.
            let uuid = guid();
            //ç”Ÿæˆsvgå…ƒç´ .
            let svg = svgGenerate(uuid);
            //åˆ›å»ºä¸€ä¸ªdiv,æ’å…¥svgå…ƒç´ .
            let div = window.document.createElement("div");
            //å·¦ä¾§æµ®åŠ¨å…ƒç´ ,æµ‹è¯•ç”¨.
            div.style.float = "left";
            //ç›´æ¥å°†svgå…ƒç´ æ’å…¥divä¸­,å…¼å®¹æ€§æœ€å¥½.
            div.innerHTML = `${svg}`;
            let main = document.getElementById("main");
            //æ·»åŠ divå…ƒç´ åˆ°mainä¸­.
            main.appendChild(div);
        }

        //å¡é€šå›¾svgæ¨¡æ¿.
        function svgTemplate(option) {
            return `
    <svg width="120" height="120" viewBox="0 0 300 300" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="--avataaar-hair-color:${option.hairColor}; --avataaar-facial-hair-color:${option.facialHairColor}; --avataaar-hat-color:${option.hatColor}; --avataaar-shirt-color:${option.shirtColor};">
        <defs><!-- èƒŒæ™¯åœ†å½¢,åŠå¾„çš„å¤§å°å¯ä»¥è°ƒæ•´.ä¸ stroke-width é…åˆä½¿ç”¨.-->
        <circle id="path-1" cx="120" cy="120" r="125"></circle>
            <!-- é®ç½©,ä¸»è¦æ˜¯ä¸ºäº†åœ†å½¢èƒŒæ™¯ä½¿ç”¨,ä½†æ˜¯ä½¿ç”¨è£å‰ªä¸å¤ªå¥½ä½¿,éœ€è¦è¿›ä¸€æ­¥çœ‹çœ‹ -->
            <path d="M12,160 C12,226 65,280 132,280 C198,280 252,226 252,160 L264,160 L264,-1 L-3,-1 L-3,160 L12,160 Z" id="path-3"></path>
            <!-- æ•´ä¸ªå›¾åƒçš„è½®å»“. -->
            <path d="M124,144 L124,163 L128,163 L128,163 C167,163 200,195 200,235 L200,244 L0,244 L0,235 C-4,195 32,163 72,163 L72,163 L76,163 L76,144 C58,136 46,119 44,99 C38,99 34,94 34,88 L34,74 C34,68 38,63 44,62 L44,56 L44,56 C44,25 69,5 100,0 L100,0 L100,0 C130,-5 156,25 156,56 L156,62 C161,63 166,68 166,74 L166,88 C166,94 161,99 155,99 C153,119 141,136 124,144 Z" id="path-silhouette"></path>
        </defs>
        <g id="Avataaar" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
          <g transform="translate(-825, -1100)" id="Avataaar/Circle">
            <g transform="translate(825, 1100)">
            <!-- æ–¹å½¢çš„æ¡†.height="245" éœ€è¦éšæ—¶è°ƒæ•´. -->
            <!-- -->
            <g id="Square" transform="translate(12, 40)">
                    <g id="Color/Palette/Blue-01" fill="#65C9FF">
                        <rect id="ğŸ–Color" x="0" y="0" width="240" height="245" stroke="red" fill="#e1e89d" stroke-width="10" stroke-opacity="0.6" fill-opacity="0.6"></rect>
                    </g>
                </g>
            <g id="Avataaar" stroke-width="1" fill-rule="evenodd" fill="black">

            <!-- åœ†å½¢çš„æ¡†. -->
            <!--
            <g id="Circle" transform="translate(12, 40)">
                <use id="Circle-Background" stroke="red" fill="#e1e89d" stroke-width="10" stroke-opacity="0.6" fill-opacity="0.6"  xlink:href="#path-1" ></use>
            </g>
            <mask id="mask-4" fill="white"><use xlink:href="#path-3"></use></mask>
            <g id="Avataaar" fill="black" mask="url(#mask-4)">
            -->
                <!-- stroke-width="1" fill-rule="evenodd"-->
                <!-- èº«ä½“éƒ¨åˆ† -->
                <g id="Body" transform="translate(32, 36)">
                    <!-- ä½¿ç”¨è½®å»“,é®ç½©è„–å­å’Œä¸‹å·´è¿æ¥å¤„å¢åŠ ä¸€ç‚¹é˜´å½±. -->
                    <mask id="mask-silhouette" fill="white"><use xlink:href="#path-silhouette"></use></mask>
                    <!-- å¤åˆ¶è½®å»“,æ›´æ”¹çš®è‚¤é¢œè‰². -->
                    <use fill="${option.skinColor}" xlink:href="#path-silhouette"></use>
                    <!-- è„–å­å’Œä¸‹å·´è¿æ¥å¤„å¢åŠ ä¸€ç‚¹é˜´å½±. -->
                    <path d="M156,79 L156,102 C156,132 130,158 100,158 C69,158 44,132 44,102 L44,79 L44,94 C44,124 69,150 100,150 C130,150 156,124 156,94 L156,79 Z" id="Neck-Shadow" fill-opacity="0.1" fill="#000000" mask="url(#mask-silhouette)"></path>
                </g>
                <!-- å…¶ä»–éƒ¨åˆ† -->
                <svg>${option.mouthType}</svg>
                <svg>${option.eyeType}</svg>
                <svg>${option.topType}</svg>
                <svg>${option.clothesType}</svg>
                <svg>${option.eyebrowType}</svg>
                <svg>${option.facialHairType}</svg>
                <svg>${option.accessoriesType}</svg>
                <svg>${option.graphicShirtType}</svg>
            </g>
          </g>
         </g>
        </g>
    </svg>`
        }
    </script>
</head>
<body>
<button onclick="createSvg()">åˆ›å»º</button>
<button onclick="clearSvg()">æ¸…é™¤</button>
<div id="main"></div>
</body>
</html>